plugins {
    id "java-library"
    id "com.google.protobuf" version "0.9.1"
}


java {
//    sourceSets.getByName("main").resources.srcDir("src/main/proto")
}


dependencies {
    api platform(project(":rb-platform"))
//    protobuf(project(":rb-protos"))

    api("io.grpc:grpc-protobuf:${grpcVersion}")
    api("io.grpc:grpc-kotlin-stub:${grpcKotlinVersion}")
    api("com.google.protobuf:protobuf-kotlin:${protobufVersion}")
//    api("com.google.protobuf:protobuf-kotlin:")
}



protobuf {
    protoc {
        artifact = "com.google.protobuf:protoc:${protobufVersion}"
    }

    plugins {
        grpc {
            artifact = "io.grpc:protoc-gen-grpc-java:1.50.2"
        }
        grpckt {
            /*why u need this , check from : https://repo1.maven.org/maven2/io/grpc/protoc-gen-grpc-kotlin/1.3.0/*/
            artifact = "io.grpc:protoc-gen-grpc-kotlin:${grpcKotlinVersion}:jdk8@jar"
//            artifact = "io.grpc:protoc-gen-grpc-kotlin:${grpcKotlinVersion}"
        }
    }


    generateProtoTasks {
        all().each {
            it.plugins {
                it.register("grpckt")
                it.register("grpc")
            }
            it.builtins {
                it.register("kotlin")
            }
        }

    }


}