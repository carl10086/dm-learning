plugins {
    id "application"
    id "org.jetbrains.kotlin.plugin.jpa" version "$kotlinVersion"
    id "org.jetbrains.kotlin.plugin.allopen" version "$kotlinVersion"
    id "com.google.protobuf" version "0.9.1"
}

dependencies {
    api platform(project(":rb-platform"))
    api project(":rb-protos")

//    protobuf(project(":rb-protos"))

    implementation(project(":rb-base-core"))

    implementation("com.linecorp.armeria:armeria:")
    implementation("com.linecorp.armeria:armeria-protobuf:")
    implementation("com.linecorp.armeria:armeria-grpc:")
    implementation("com.linecorp.armeria:armeria-spring-boot2-starter:")
    implementation("org.springframework.boot:spring-boot-starter-web:")
    implementation("org.springframework.boot:spring-boot-starter-data-jpa:")
    implementation("io.grpc:grpc-kotlin-stub:${grpcKotlinVersion}")
    implementation("com.google.protobuf:protobuf-kotlin:${protobufVersion}")
//    implementation("com.google.protobuf:protobuf-kotlin:")
    implementation 'com.h2database:h2'

    testImplementation("org.junit.jupiter:junit-jupiter")
    testImplementation("org.assertj:assertj-core")
}


//protobuf {
//    protoc {
//        artifact = "com.google.protobuf:protoc:${protobufVersion}"
//    }
//
//    plugins {
//        grpc {
//            artifact = "io.grpc:protoc-gen-grpc-java:1.50.2"
//        }
//        grpckt {
//            /*why u need this , check from : https://repo1.maven.org/maven2/io/grpc/protoc-gen-grpc-kotlin/1.3.0/*/
//            artifact = "io.grpc:protoc-gen-grpc-kotlin:${grpcKotlinVersion}:jdk8@jar"
////            artifact = "io.grpc:protoc-gen-grpc-kotlin:${grpcKotlinVersion}"
//        }
//    }
//
//
//    generateProtoTasks {
//        all().each {
//            it.plugins {
//                it.register("grpckt")
//                it.register("grpc")
//            }
//            it.builtins {
//                it.register("kotlin")
//            }
//        }
//    }
//
//}